<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoyaltyChess - Special Rules Edition</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            background-color: #1a1a1a;
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            color: #ecf0f1;
        }

        .header { margin: 20px 0; text-align: center; }
        .header h1 { color: #f1c40f; margin-bottom: 5px; }

        .main-container {
            display: flex;
            gap: 30px;
            padding: 20px;
            background-color: #2c3e50;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.7);
            flex-wrap: wrap;
            justify-content: center;
        }

        #chess-board {
            display: grid;
            grid-template-columns: repeat(8, 65px);
            grid-template-rows: repeat(8, 65px);
            border: 5px solid #34495e;
        }

        .square {
            width: 65px; height: 65px;
            display: flex; justify-content: center; align-items: center;
        }

        .white { background-color: #ebecd0; }
        .black { background-color: #779556; }

        .piece {
            width: 90%; height: 90%;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            transition: all 0.4s ease;
        }

        /* İHANET EFEKTİ (Sadece At, Fil, Kale için) */
        .betrayal-glow {
            filter: drop-shadow(0 0 10px red) sepia(1) saturate(5) hue-rotate(-50deg);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .side-panel { max-width: 350px; display: flex; flex-direction: column; gap: 15px; }
        .step-box { background-color: #16a085; padding: 15px; border-radius: 8px; font-weight: bold; }
        .info-box { background-color: #34495e; padding: 20px; border-radius: 10px; border-left: 5px solid #e74c3c; }
        
        button {
            padding: 12px; background-color: #f1c40f; border: none; border-radius: 5px;
            font-weight: bold; cursor: pointer; font-size: 16px;
        }

        /* SVG Linkleri */
        .w-p { background-image: url('https://upload.wikimedia.org/wikipedia/commons/4/45/Chess_plt45.svg'); }
        .w-n { background-image: url('https://upload.wikimedia.org/wikipedia/commons/7/70/Chess_nlt45.svg'); }
        .b-r { background-image: url('https://upload.wikimedia.org/wikipedia/commons/f/ff/Chess_rdt45.svg'); }
        .b-p { background-image: url('https://upload.wikimedia.org/wikipedia/commons/c/c7/Chess_pdt45.svg'); }
    </style>
</head>
<body>

<div class="header">
    <h1>LoyaltyChess</h1>
    <p>Exclusive Rules: Betrayal mechanics for Rooks, Knights, and Bishops.</p>
</div>

<div class="main-container">
    <div id="chess-board"></div>

    <div class="side-panel">
        <div id="tutorial-text" class="step-box">
            Ready to see the Rook's betrayal? Click Next.
        </div>
        
        <button onclick="nextStep()">Next Step</button>

        <div class="info-box">
            <h3>Special Limitations</h3>
            <p style="color: #f1c40f;"><b>Note:</b> Pawns (♙) and Queens (♕) are <u>EXEMPT</u> from betrayal. They are too loyal (or too important) to betray their King!</p>
            <p>Only Rooks, Knights, and Bishops can become Traitors.</p>
        </div>
    </div>
</div>

<script>
    const board = document.getElementById('chess-board');
    let currentStep = 0;

    const piecesToClass = {
        'P': 'w-p', 'N': 'w-n',
        'p': 'b-p', 'r': 'b-r'
    };

    // Senaryo: Siyah Kale (Rook) üzerinden örnekleme
    const tutorialSteps = [
        { msg: "White plays Pawn to e4.", moves: { 52: '', 36: 'P' } },
        { msg: "Black plays Rook to a6 (improper move for tutorial).", moves: { 0: '', 16: 'r' } },
        { msg: "White moves Knight to f3, threatening the Black Rook!", moves: { 62: '', 45: 'N' } },
        { msg: "Black plays Pawn to h6, leaving the Rook undefended.", moves: { 15: '', 23: 'p' } },
        { msg: "BETRAYAL! The Rook is now a Traitor. (Pawns & Queens wouldn't do this!)", betray: 16 },
        { msg: "The traitor Rook captures the Black Pawn and leaves the game!", moves: { 16: '', 23: 'r' }, remove: 23 }
    ];

    let layout = Array(64).fill('');
    layout[52] = 'P'; layout[0] = 'r'; layout[62] = 'N'; layout[15] = 'p';

    function renderBoard() {
        board.innerHTML = '';
        for (let i = 0; i < 64; i++) {
            const square = document.createElement('div');
            square.className = square ${(Math.floor(i/8) + (i%8)) % 2 === 0 ? 'white' : 'black'};
            
            if (layout[i]) {
                const piece = document.createElement('div');
                piece.className = piece ${piecesToClass[layout[i]]};
                // Sadece kurala dahil olan taşlarda (r, n, b) ihanet efekti göster
                if (i === tutorialSteps[currentStep-1]?.betray) {
                    piece.classList.add('betrayal-glow');
                }
                square.appendChild(piece);
            }
            board.appendChild(square);
        }
    }

    function nextStep() {
        if (currentStep >= tutorialSteps.length) {
            alert("Tutorial Completed!");
            return;
        }

        const step = tutorialSteps[currentStep];
        document.getElementById('tutorial-text').innerText = step.msg;

        if (step.moves) {
            for (let [idx, p] of Object.entries(step.moves)) {
                layout[idx] = p;
            }
        }
        
        renderBoard();
        currentStep++;
    }

    renderBoard();
</script>
</body>
</html>
